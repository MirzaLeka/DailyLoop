"use strict";function changeForm(e){var n=document.getElementById("form");0==e?(n.innerHTML='\n        \n        <form class="signup-form" onsubmit="register();return false">\n\n        <h2 class="formHeader">Sign Up</h2>\n\n        <input class="loginInput" name="signupUsername" type="text" placeholder="Username" autofocus/>\n    \n        <input class="loginInput" name="signupEmail" type="text" placeholder="Email"/>   \n    \n        <input class="loginInput" name="signupPassword" id="pass" type="password" placeholder="Password"/>\n\n        <input class="loginInput" name="confirmPassword" id="confirmPass" type="password" placeholder="Confirm Password"/>\n    <br>\n        <input class="btn btn-success formBtn" type="submit" id="confirmBtn" value="REGISTER"/>\n    \n        <p class="changeForm" onclick="changeForm(1)">Already a member?</p>\n\n    </form>\n        \n        ',extraValidation()):(n.innerHTML='\n\n        <form class="signin-form" onsubmit="login();return false">\n        \n        <h2 class="formHeader">Sign In</h2>\n    \n        <input class="loginInput" oninput="fixForm()" name="signinEmail" type="email" placeholder="Email" autofocus/>\n\n        <input class="loginInput" oninput="fixForm()" name="signinPassword" id="signinPass" type="password" placeholder="Password"/>\n            <label id="loginFailed">Incorrect username or password</label>\n    <br id="breakTag">\n        <input class="btn btn-primary formBtn" type="submit" id="loginBtn" value="CONTINUE"/>\n\n        <p class="changeForm" onclick="changeForm(0)">Not a member?</p>\n\n        </form>\n        \n        ',extraConfirmation())}function register(){extraValidation();var e=$("input[name='signupUsername']").val(),n=$("input[name='signupEmail']").val(),a=$("#pass").val(),s=$("#confirmPass").val();if(""!=e&&""!=n&&""!=a&&""!=s&&a==s){var i={username:e,email:n,password:a};$.ajax({type:"POST",url:"/users",contentType:"application/json",dataType:"json",data:JSON.stringify(i),success:function(e){window.location.href="/home"},error:function(e){var n=e.responseJSON.errmsg.substr(60,199);console.log(n+"\n"),console.log(e.responseJSON.errmsg)}})}}function login(){extraConfirmation();var e=$("input[name='signinEmail']").val(),n=$("#signinPass").val();if(""!=e&&""!=n){var a={email:e,password:n};$.ajax({type:"POST",url:"/users/login",contentType:"application/json",dataType:"json",data:JSON.stringify(a),success:function(e){e&&(window.location.href="/home")},error:function(e){e&&(document.getElementById("loginFailed").style.display="block",$("#breakTag").css("display","none"))}})}}function fixForm(){$("#breakTag").css("display","block"),document.getElementById("loginFailed").style.display="none"}function extraValidation(){$.validator.addMethod("nowhitespace",function(e,n){return this.optional(n)||/^\S+$/i.test(e)},"No white space please."),$.validator.addMethod("strongUsername",function(e,n){return this.optional(n)||6<=e.length&&/[a-z]/i.test(e)},"Username must be at least 6 characters long and contain at least one letter."),$.validator.addMethod("strongPassword",function(e,n){return this.optional(n)||8<=e.length&&/\d/.test(e)&&/[a-z]/i.test(e)&&/[$-/:-?{-~!"^_`\[\]]/.test(e)},"Password must be at least 8 characters long and contain at least one number, one letter and one symbol."),$(".signup-form").validate({rules:{signupUsername:{required:!0,nowhitespace:!0,strongUsername:!0,maxlength:24},signupEmail:{required:!0,email:!0},signupPassword:{required:!0,strongPassword:!0,nowhitespace:!0,maxlength:32},confirmPassword:{required:!0,equalTo:"#pass",nowhitespace:!0},messages:{signupEmail:{required:"Please enter an email address.",email:"Please enter a valid email address."}}}})}function extraConfirmation(){$(".signin-form").validate({rules:{signinEmail:{required:!0,email:!0},signinPassword:{required:!0},messages:{signinEmail:{required:"Please enter an email address.",email:"Please enter a valid email address."}}}})}$(function(){$.validator.addMethod("nowhitespace",function(e,n){return this.optional(n)||/^\S+$/i.test(e)},"No white space please."),$.validator.addMethod("strongUsername",function(e,n){return this.optional(n)||6<=e.length&&/[a-z]/i.test(e)},"Username must be at least 6 characters long and contain at least one letter."),$.validator.addMethod("strongPassword",function(e,n){return this.optional(n)||8<=e.length&&/\d/.test(e)&&/[a-z]/i.test(e)&&/[$-/:-?{-~!"^_`\[\]]/.test(e)},"Password must be at least 8 characters long and contain at least one number, one letter and one symbol."),$(".signin-form").validate({rules:{signinEmail:{required:!0,email:!0},signinPassword:{required:!0,strongPassword:!0,nowhitespace:!0,maxlength:32},messages:{signinEmail:{required:"Please enter an email address.",email:"Please enter a valid email address."}}}}),$(".signup-form").validate({rules:{signupUsername:{required:!0,nowhitespace:!0,strongUsername:!0,maxlength:24},signupEmail:{required:!0,email:!0},signupPassword:{required:!0,strongPassword:!0,nowhitespace:!0,maxlength:32},confirmPassword:{required:!0,equalTo:"#pass",nowhitespace:!0},messages:{signupEmail:{required:"Please enter an email address.",email:"Please enter a valid email address."}}}})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2luLmpzIl0sIm5hbWVzIjpbImNoYW5nZUZvcm0iLCJudW0iLCJmb3JtIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsInZhbGlkYXRvciIsImV4dHJhQ29uZmlybWF0aW9uIiwicmVnaXN0ZXIiLCJleHRyYVZhbGlkYXRpb24iLCJ1c2VybmFtZSIsIiQiLCJ2YWwiLCJlbWFpbCIsInBhc3N3b3JkIiwiZGF0YSIsInR5cGUiLCJjb25maXJtIiwiSlNPTiIsInN1Y2Nlc3MiLCJhamF4IiwiZXJyb3IiLCJjb250ZW50VHlwZSIsImRhdGFUeXBlIiwiZXJyIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwiZXJyVHlwZSIsInJlc3BvbnNlSlNPTiIsImVycm1zZyIsInN1YnN0ciIsImZpeEZvcm0iLCJsb2ciLCJjb25zb2xlIiwiY3NzIiwicnVsZXMiLCJyZXF1aXJlZCIsInN0cm9uZ1Bhc3N3b3JkIiwibm93aGl0ZXNwYWNlIiwibWF4bGVuZ3RoIiwiY29uZmlybVBhc3N3b3JkIiwiZXF1YWxUbyIsIm1lc3NhZ2VzIiwic3R5bGUiLCJkaXNwbGF5IiwiYWRkTWV0aG9kIiwidmFsdWUiLCJlbGVtZW50IiwidGhpcyIsIm9wdGlvbmFsIiwidGVzdCIsImxlbmd0aCIsInZhbGlkYXRlIiwic2lnbnVwVXNlcm5hbWUiLCJzdHJvbmdVc2VybmFtZSIsInNpZ251cEVtYWlsIiwic2lnbnVwUGFzc3dvcmQiLCJzaWduaW5FbWFpbCIsInNpZ25pblBhc3N3b3JkIiwic3RyaW5naWZ5Il0sIm1hcHBpbmdzIjoiYUFDQSxTQUFTQSxXQUFXQyxHQUVoQixJQUFJQyxFQUFPQyxTQUFTQyxlQUFlLFFBRXhCLEdBQVBILEdBSUFDLEVBQUtHLFVBQUwsK3hCQWlFTkMsb0JBZ0JGSixFQUFBRyxVQUFBLDByQkFja0JFLHFCQW1EbEIsU0FBU0MsV0ErRERDLGtCQTNESixJQUFJQyxFQUFXQyxFQUFFLGdDQUFnQ0MsTUE4RGpEQyxFQUFBRixFQUFBLDZCQUFBQyxNQTVESUUsRUFBV0gsRUFBRSxTQUFTQyxNQThEdEJHLEVBQU9KLEVBQUEsZ0JBQUFDLE1BRVAsR0FBYUUsSUFBYkosR0FBYUksSUFBQUEsR0FBQUEsSUFBQUEsR0FBQUEsSUFBQUEsR0FJYkUsR0FER0MsRUFDSEQsQ0FJQUQsSUFBQUEsRUFBT0csQ0FDUEMsU0FBU1QsRUE1RFRHLE1BQVVBLEVBOEROQyxTQUFBQSxHQUlISCxFQUFBUyxLQVpFLENBakRISixLQUFNLE9BK0RWSyxJQUFBQSxTQTdESUMsWUFBYyxtQkErRGRDLFNBQUlDLE9BQ0FyQixLQUFBQSxLQUFBQSxVQUFTQyxHQUNUTyxRQUFBQSxTQUFFSSxHQUdUVSxPQUFBQyxTQUFBQyxLQUFBLFNBSUpOLE1BQUEsU0FBQUcsR0FFRyxJQUFBSSxFQUFBSixFQUFBSyxhQUFBQyxPQUFBQyxPQUFBLEdBQUEsS0FFTUMsUUFBVUMsSUFBQUwsRUFBQSxNQUNkTSxRQUFhQyxJQUFJWCxFQUFBSyxhQUFXQyxZQXVCN0JuQixTQUFFTCxRQU1DQyxvQkFHSEksSUFBRUUsRUFBQUYsRUFBQSw2QkFBeUJDLE1BQ3ZCd0IsRUFBT3pCLEVBQUEsZUFBQUMsTUFFQ3lCLEdBQUFBLElBQUFBLEdBRFksSUFDWkEsRUFBQUEsQ0FNQUEsSUFBQUEsRUFBQUEsQ0FDQXhCLE1BQUFBLEVBRlNDLFNBUFZBLEdBYUN3QixFQUFBQSxLQUFBQSxDQUNBQyxLQUFBQSxPQUNBQyxJQUFBQSxlQUpZbEIsWUFYYixtQkFpQkhtQixTQUFBQSxPQUNJSixLQUFBQSxLQUFBQSxVQURhdEIsR0FFYjJCLFFBQUFBLFNBQVMzQixHQW5CVkEsSUFzQkg0QixPQUFVakIsU0FBQUMsS0FBQSxVQUFBTixNQUFBLFNBQUFHLEdBckVYQSxJQThDUHJCLFNBQUFDLGVBQUEsZUFBQXdDLE1BQUFDLFFBQUEsUUFrQ0psQyxFQUFBLGFBQUF3QixJQUFBLFVBQUEsYUFZZUUsU0FBQUEsVUFEWTFCLEVBQUEsYUFMYndCLElBQUEsVUFBQSxTQVFIUSxTQUFBQSxlQUFVLGVBQUFDLE1BQUFDLFFBQUEsT0F4RXRCLFNBQVNwQyxrQkFtRlJFLEVBQUFMLFVBQUF3QyxVQUFBLGVBQUEsU0FBQUMsRUFBQUMsR0FoRk8sT0FBT0MsS0FBS0MsU0FBVUYsSUFDbEIsU0FBU0csS0FBTUosSUFDbkIsMEJBR0hwQyxFQUFFTCxVQUFVd0MsVUFBVSxpQkFBa0IsU0FBU0MsRUFBT0MsR0FDcEQsT0FBT0MsS0FBS0MsU0FBU0YsSUFDQSxHQUFoQkQsRUFBTUssUUFDTixTQUFTRCxLQUFLSixJQUNsQixnRkFHTHBDLEVBQUVMLFVBQVV3QyxVQUFVLGlCQUFrQixTQUFTQyxFQUFPQyxHQUNwRCxPQUFPQyxLQUFLQyxTQUFTRixJQUNBLEdBQWhCRCxFQUFNSyxRQUNOLEtBQUtELEtBQUtKLElBQ1YsU0FBU0ksS0FBS0osSUFDZCx1QkFBdUJJLEtBQUtKLElBQ2hDLDJHQUdMcEMsRUFBRSxnQkFBZ0IwQyxTQUFTLENBQ3ZCakIsTUFBTyxDQUNIa0IsZUFBZ0IsQ0FDWmpCLFVBQVUsRUFDVkUsY0FBYyxFQUNkZ0IsZ0JBQWdCLEVBQ2hCZixVQUFXLElBRWZnQixZQUFhLENBQ1RuQixVQUFVLEVBQ1Z4QixPQUFPLEdBRVg0QyxlQUFnQixDQUNacEIsVUFBVSxFQUNWQyxnQkFBZ0IsRUFDaEJDLGNBQWMsRUFDZEMsVUFBVyxJQUVmQyxnQkFBaUIsQ0FDYkosVUFBVSxFQUNWSyxRQUFTLFFBQ1RILGNBQWMsR0FFbEJJLFNBQVUsQ0FDTmEsWUFBYSxDQUNUbkIsU0FBVSxpQ0FDVnhCLE1BQU8sMkNBVzVCLFNBQVNOLG9CQUVMSSxFQUFFLGdCQUFnQjBDLFNBQVMsQ0FDdkJqQixNQUFPLENBQ0hzQixZQUFhLENBQ1RyQixVQUFVLEVBQ1Z4QixPQUFPLEdBRVg4QyxlQUFnQixDQUNadEIsVUFBVSxHQUVkTSxTQUFVLENBQ05lLFlBQWEsQ0FDVHJCLFNBQVUsaUNBQ1Z4QixNQUFPLDJDQS9OdkJ1QixFQUFBQSxXQUVRQyxFQUFBQSxVQUFBQSxVQUFBQSxlQURZLFNBQUFVLEVBQUFDLEdBRVpULE9BQUFBLEtBQUFBLFNBQUFBLElBQ0FnQixTQUFBQSxLQUFBQSxJQUNBZiwwQkFHQUgsRUFBQUEsVUFBQUEsVUFBQUEsaUJBRFMsU0FBQVUsRUFBQUMsR0FFVG5DLE9BQUFBLEtBQUFBLFNBQU9tQyxJQVRSLEdBT1VELEVBUFZLLFFBV0hLLFNBQUFBLEtBQUFBLElBQ0lwQixnRkFHQUcsRUFBQUEsVUFBQUEsVUFBQUEsaUJBQVcsU0FBQU8sRUFBQUMsR0FKQyxPQUFBQyxLQVhiQyxTQUFBRixJQWlCSFAsR0FBQUEsRUFBQUEsUUFDSUosS0FBQUEsS0FBQUEsSUFDQUssU0FBQUEsS0FBQUEsSUFDQUgsdUJBQWNZLEtBQUFKLElBSEQsMkdBTUFwQyxFQUFBLGdCQUFBMEMsU0FBQSxDQURQakIsTUFBQSxDQXRCUHNCLFlBQUEsQ0F2QkNyQixVQUFVLEVBc0J0QnhCLE9BQUEsR0FuQlE4QyxlQUFnQixDQXlEZm5ELFVBQVcsRUF2RFI4QixnQkFBZ0IsRUF5RHhCN0IsY0FBQUEsRUF2RFErQixVQUFXLElBMERmM0IsU0FBVSxDQUNWQyxZQUFhLENBQ2JHLFNBQVksaUNBdkRKSixNQUFPLDJDQWtFZkYsRUFBQSxnQkFBQTBDLFNBQWEzQyxDQUNiMEIsTUFBQSxDQUNBa0IsZUFBYXhDLENBSGpCdUIsVUFBQSxFQW5EUUUsY0FBYyxFQXlEZmdCLGdCQUFBLEVBQ0h2QyxVQURHLElBR0hNLFlBQWMsQ0FDZEMsVUFBVSxFQUNWUixPQUFZNkMsR0F0RFpILGVBQWdCLENBeURoQmhDLFVBQU9DLEVBUkpZLGdCQUFBLEVBOUNDQyxjQUFjLEVBeURsQmxCLFVBQU8sSUFFSm9CLGdCQUFJYixDQXZESFMsVUFBVSxFQXlEWEgsUUFBUUQsUUFDUkMsY0FBWVYsR0FFZm1CLFNBQUEsQ0FDQWEsWUFBQSxDQUNBbkIsU0FBQSxpQ0FDQXhCLE1BQUEiLCJmaWxlIjoibG9naW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuZnVuY3Rpb24gY2hhbmdlRm9ybShudW0pIHtcclxuXHJcbiAgICBsZXQgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZm9ybVwiKTtcclxuXHJcbiAgICBpZiAobnVtID09IDApIHtcclxuICAgIFxyXG4gICAgICAgIC8qIFNpZ24gdXAgRm9ybSAqL1xyXG5cclxuICAgICAgICBmb3JtLmlubmVySFRNTCA9IGBcclxuICAgICAgICBcclxuICAgICAgICA8Zm9ybSBjbGFzcz1cInNpZ251cC1mb3JtXCIgb25zdWJtaXQ9XCJyZWdpc3RlcigpO3JldHVybiBmYWxzZVwiPlxyXG5cclxuICAgICAgICA8aDIgY2xhc3M9XCJmb3JtSGVhZGVyXCI+U2lnbiBVcDwvaDI+XHJcblxyXG4gICAgICAgIDxpbnB1dCBjbGFzcz1cImxvZ2luSW5wdXRcIiBuYW1lPVwic2lnbnVwVXNlcm5hbWVcIiB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiVXNlcm5hbWVcIiBhdXRvZm9jdXMvPlxyXG4gICAgXHJcbiAgICAgICAgPGlucHV0IGNsYXNzPVwibG9naW5JbnB1dFwiIG5hbWU9XCJzaWdudXBFbWFpbFwiIHR5cGU9XCJ0ZXh0XCIgcGxhY2Vob2xkZXI9XCJFbWFpbFwiLz4gICBcclxuICAgIFxyXG4gICAgICAgIDxpbnB1dCBjbGFzcz1cImxvZ2luSW5wdXRcIiBuYW1lPVwic2lnbnVwUGFzc3dvcmRcIiBpZD1cInBhc3NcIiB0eXBlPVwicGFzc3dvcmRcIiBwbGFjZWhvbGRlcj1cIlBhc3N3b3JkXCIvPlxyXG5cclxuICAgICAgICA8aW5wdXQgY2xhc3M9XCJsb2dpbklucHV0XCIgbmFtZT1cImNvbmZpcm1QYXNzd29yZFwiIGlkPVwiY29uZmlybVBhc3NcIiB0eXBlPVwicGFzc3dvcmRcIiBwbGFjZWhvbGRlcj1cIkNvbmZpcm0gUGFzc3dvcmRcIi8+XHJcbiAgICA8YnI+XHJcbiAgICAgICAgPGlucHV0IGNsYXNzPVwiYnRuIGJ0bi1zdWNjZXNzIGZvcm1CdG5cIiB0eXBlPVwic3VibWl0XCIgaWQ9XCJjb25maXJtQnRuXCIgdmFsdWU9XCJSRUdJU1RFUlwiLz5cclxuICAgIFxyXG4gICAgICAgIDxwIGNsYXNzPVwiY2hhbmdlRm9ybVwiIG9uY2xpY2s9XCJjaGFuZ2VGb3JtKDEpXCI+QWxyZWFkeSBhIG1lbWJlcj88L3A+XHJcblxyXG4gICAgPC9mb3JtPlxyXG4gICAgICAgIFxyXG4gICAgICAgIGA7XHJcblxyXG4gICAgICAgIGV4dHJhVmFsaWRhdGlvbigpO1xyXG5cclxuICAgICAgICAvLyBhY3Rpb249XCIvaG9tZVwiIG1ldGhvZD1cImdldFwiXHJcblxyXG4gICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgLyogU2lnbiBpbiBGb3JtICovXHJcblxyXG4gICAgICAgIGZvcm0uaW5uZXJIVE1MID0gYFxyXG5cclxuICAgICAgICA8Zm9ybSBjbGFzcz1cInNpZ25pbi1mb3JtXCIgb25zdWJtaXQ9XCJsb2dpbigpO3JldHVybiBmYWxzZVwiPlxyXG4gICAgICAgIFxyXG4gICAgICAgIDxoMiBjbGFzcz1cImZvcm1IZWFkZXJcIj5TaWduIEluPC9oMj5cclxuICAgIFxyXG4gICAgICAgIDxpbnB1dCBjbGFzcz1cImxvZ2luSW5wdXRcIiBvbmlucHV0PVwiZml4Rm9ybSgpXCIgbmFtZT1cInNpZ25pbkVtYWlsXCIgdHlwZT1cImVtYWlsXCIgcGxhY2Vob2xkZXI9XCJFbWFpbFwiIGF1dG9mb2N1cy8+XHJcblxyXG4gICAgICAgIDxpbnB1dCBjbGFzcz1cImxvZ2luSW5wdXRcIiBvbmlucHV0PVwiZml4Rm9ybSgpXCIgbmFtZT1cInNpZ25pblBhc3N3b3JkXCIgaWQ9XCJzaWduaW5QYXNzXCIgdHlwZT1cInBhc3N3b3JkXCIgcGxhY2Vob2xkZXI9XCJQYXNzd29yZFwiLz5cclxuICAgICAgICAgICAgPGxhYmVsIGlkPVwibG9naW5GYWlsZWRcIj5JbmNvcnJlY3QgdXNlcm5hbWUgb3IgcGFzc3dvcmQ8L2xhYmVsPlxyXG4gICAgPGJyIGlkPVwiYnJlYWtUYWdcIj5cclxuICAgICAgICA8aW5wdXQgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgZm9ybUJ0blwiIHR5cGU9XCJzdWJtaXRcIiBpZD1cImxvZ2luQnRuXCIgdmFsdWU9XCJDT05USU5VRVwiLz5cclxuXHJcbiAgICAgICAgPHAgY2xhc3M9XCJjaGFuZ2VGb3JtXCIgb25jbGljaz1cImNoYW5nZUZvcm0oMClcIj5Ob3QgYSBtZW1iZXI/PC9wPlxyXG5cclxuICAgICAgICA8L2Zvcm0+XHJcbiAgICAgICAgXHJcbiAgICAgICAgYDtcclxuXHJcbiAgICAgICAgZXh0cmFDb25maXJtYXRpb24oKTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxufVxyXG5cclxuXHJcbiQoZnVuY3Rpb24oKSB7XHJcblxyXG4kLnZhbGlkYXRvci5hZGRNZXRob2QoIFwibm93aGl0ZXNwYWNlXCIsIGZ1bmN0aW9uKCB2YWx1ZSwgZWxlbWVudCApIHtcclxuICAgcmV0dXJuIHRoaXMub3B0aW9uYWwoIGVsZW1lbnQgKVxyXG4gICAgfHwgL15cXFMrJC9pLnRlc3QoIHZhbHVlICk7XHJcbn0sIFwiTm8gd2hpdGUgc3BhY2UgcGxlYXNlLlwiKTsgICBcclxuXHJcblxyXG4kLnZhbGlkYXRvci5hZGRNZXRob2QoJ3N0cm9uZ1VzZXJuYW1lJywgZnVuY3Rpb24odmFsdWUsIGVsZW1lbnQpIHtcclxuICAgIHJldHVybiB0aGlzLm9wdGlvbmFsKGVsZW1lbnQpIFxyXG4gICAgICB8fCB2YWx1ZS5sZW5ndGggPj0gNlxyXG4gICAgICAmJiAvW2Etel0vaS50ZXN0KHZhbHVlKTtcclxuICB9LCAnVXNlcm5hbWUgbXVzdCBiZSBhdCBsZWFzdCA2IGNoYXJhY3RlcnMgbG9uZyBhbmQgY29udGFpbiBhdCBsZWFzdCBvbmUgbGV0dGVyLicpXHJcblxyXG5cclxuJC52YWxpZGF0b3IuYWRkTWV0aG9kKCdzdHJvbmdQYXNzd29yZCcsIGZ1bmN0aW9uKHZhbHVlLCBlbGVtZW50KSB7XHJcbiAgICByZXR1cm4gdGhpcy5vcHRpb25hbChlbGVtZW50KSBcclxuICAgICAgfHwgdmFsdWUubGVuZ3RoID49IDhcclxuICAgICAgJiYgL1xcZC8udGVzdCh2YWx1ZSlcclxuICAgICAgJiYgL1thLXpdL2kudGVzdCh2YWx1ZSlcclxuICAgICAgJiYgL1skLS86LT97LX4hXCJeX2BcXFtcXF1dLy50ZXN0KHZhbHVlKTtcclxuICB9LCAnUGFzc3dvcmQgbXVzdCBiZSBhdCBsZWFzdCA4IGNoYXJhY3RlcnMgbG9uZyBhbmQgY29udGFpbiBhdCBsZWFzdCBvbmUgbnVtYmVyLCBvbmUgbGV0dGVyIGFuZCBvbmUgc3ltYm9sLicpXHJcblxyXG5cclxuLyogU2lnbiBJbiBmb3JtIHZhbGlkYXRpb24gKi9cclxuXHJcbiQoXCIuc2lnbmluLWZvcm1cIikudmFsaWRhdGUoe1xyXG4gICAgcnVsZXM6IHtcclxuICAgICAgICBzaWduaW5FbWFpbDoge1xyXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZW1haWw6IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNpZ25pblBhc3N3b3JkOiB7XHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICBzdHJvbmdQYXNzd29yZDogdHJ1ZSxcclxuICAgICAgICAgICAgbm93aGl0ZXNwYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICBtYXhsZW5ndGg6IDMyXHJcbiAgICAgICAgfSxcclxuICAgICAgICBtZXNzYWdlczoge1xyXG4gICAgICAgICAgICBzaWduaW5FbWFpbDoge1xyXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFwiUGxlYXNlIGVudGVyIGFuIGVtYWlsIGFkZHJlc3MuXCIsXHJcbiAgICAgICAgICAgICAgICBlbWFpbDogXCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzLlwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxufSk7XHJcblxyXG4vKiBTaWduIFVwIGZvcm0gdmFsaWRhdGlvbiAqL1xyXG5cclxuJChcIi5zaWdudXAtZm9ybVwiKS52YWxpZGF0ZSh7XHJcbiAgICBydWxlczoge1xyXG4gICAgICAgIHNpZ251cFVzZXJuYW1lOiB7XHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICBub3doaXRlc3BhY2U6IHRydWUsXHJcbiAgICAgICAgICAgIHN0cm9uZ1VzZXJuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICBtYXhsZW5ndGg6IDI0XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzaWdudXBFbWFpbDoge1xyXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZW1haWw6IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNpZ251cFBhc3N3b3JkOiB7XHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICBzdHJvbmdQYXNzd29yZDogdHJ1ZSxcclxuICAgICAgICAgICAgbm93aGl0ZXNwYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICBtYXhsZW5ndGg6IDMyXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb25maXJtUGFzc3dvcmQ6IHtcclxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGVxdWFsVG86IFwiI3Bhc3NcIixcclxuICAgICAgICAgICAgbm93aGl0ZXNwYWNlOiB0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBtZXNzYWdlczoge1xyXG4gICAgICAgICAgICBzaWdudXBFbWFpbDoge1xyXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFwiUGxlYXNlIGVudGVyIGFuIGVtYWlsIGFkZHJlc3MuXCIsXHJcbiAgICAgICAgICAgICAgICBlbWFpbDogXCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzLlwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxufSk7XHJcblxyXG59KTtcclxuXHJcblxyXG5cclxuZnVuY3Rpb24gcmVnaXN0ZXIoKSB7XHJcblxyXG4gICAgZXh0cmFWYWxpZGF0aW9uKCk7XHJcblxyXG4gICAgbGV0IHVzZXJuYW1lID0gJChcImlucHV0W25hbWU9J3NpZ251cFVzZXJuYW1lJ11cIikudmFsKCk7XHJcbiAgICBsZXQgZW1haWwgPSAkKFwiaW5wdXRbbmFtZT0nc2lnbnVwRW1haWwnXVwiKS52YWwoKTtcclxuICAgIGxldCBwYXNzd29yZCA9ICQoXCIjcGFzc1wiKS52YWwoKTtcclxuICAgIGxldCBjb25maXJtID0gJChcIiNjb25maXJtUGFzc1wiKS52YWwoKTtcclxuXHJcbiAgICBpZiAodXNlcm5hbWUgPT0gXCJcIiB8fCBlbWFpbCA9PSBcIlwiIHx8IHBhc3N3b3JkID09IFwiXCIgfHwgY29uZmlybSA9PSBcIlwiKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChwYXNzd29yZCAhPSBjb25maXJtKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBkYXRhID0ge1xyXG4gICAgICAgIFwidXNlcm5hbWVcIiA6IHVzZXJuYW1lLFxyXG4gICAgICAgIFwiZW1haWxcIiA6IGVtYWlsLFxyXG4gICAgICAgIFwicGFzc3dvcmRcIiA6IHBhc3N3b3JkXHJcbiAgICB9O1xyXG5cclxuICAgICQuYWpheCh7XHJcbiAgICAgICAgdHlwZTogXCJQT1NUXCIsXHJcbiAgICAgICAgdXJsOiBcIi91c2Vyc1wiLFxyXG4gICAgICAgIGNvbnRlbnRUeXBlIDogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICBkYXRhIDogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cclxuICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL2hvbWVcIjtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7XHJcblxyXG4gICAgICAgICAgIHZhciBlcnJUeXBlID0gIGVyci5yZXNwb25zZUpTT04uZXJybXNnLnN1YnN0cig2MCwgMTk5KTtcclxuXHJcbiAgICAgICAgICAgY29uc29sZS5sb2coZXJyVHlwZSArIFwiXFxuXCIpO1xyXG4gICAgICAgICAgIGNvbnNvbGUubG9nKGVyci5yZXNwb25zZUpTT04uZXJybXNnKTtcclxuXHJcbiAgICAgICAgLy8gICAgaWYgKGVyclR5cGUuc3RhcnRzV2l0aChcInVcIikpIHtcclxuICAgICAgICAvLyAgICAgYWxlcnQoXCJVc2VybmFtZSBpcyBhbHJlYWR5IGluIHVzZVwiKTtcclxuICAgICAgICAvLyAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vICAgICBhbGVydChcIkVtYWlsIGlzIGFscmVhZHkgaW4gdXNlXCIpO1xyXG4gICAgICAgIC8vICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG5cclxufVxyXG5cclxuXHJcblxyXG5mdW5jdGlvbiBsb2dpbigpIHtcclxuXHJcbiAgICBleHRyYUNvbmZpcm1hdGlvbigpO1xyXG5cclxuICAgIGxldCBlbWFpbCA9ICQoXCJpbnB1dFtuYW1lPSdzaWduaW5FbWFpbCddXCIpLnZhbCgpO1xyXG4gICAgbGV0IHBhc3N3b3JkID0gJChcIiNzaWduaW5QYXNzXCIpLnZhbCgpO1xyXG5cclxuICAgIGlmIChlbWFpbCA9PSBcIlwiIHx8IHBhc3N3b3JkID09IFwiXCIpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdXJsOiBcIi91c2Vycy9cIiArIGVtYWlsLFxyXG5cclxuICAgIGxldCBkYXRhID0ge1xyXG4gICAgICAgIFwiZW1haWxcIiA6IGVtYWlsLFxyXG4gICAgICAgIFwicGFzc3dvcmRcIiA6IHBhc3N3b3JkXHJcbiAgICB9XHJcblxyXG4gICAgJC5hamF4KHtcclxuICAgICAgICB0eXBlOiBcIlBPU1RcIixcclxuICAgICAgICB1cmw6IFwiL3VzZXJzL2xvZ2luXCIsXHJcbiAgICAgICAgY29udGVudFR5cGUgOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgZGF0YVR5cGUgOiAnanNvbicsXHJcbiAgICAgICAgZGF0YSA6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxyXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL2hvbWVcIjtcclxuICAgICAgICAgICAgfSBcclxuXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICBlcnJvcjogZnVuY3Rpb24gKGVycikge1xyXG5cclxuICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9naW5GYWlsZWRcIikuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgICAgICAgJChcIiNicmVha1RhZ1wiKS5jc3MoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxufVxyXG5cclxuICAgIC8qIFJlbW92ZSBsYWJlbCBhbmQgZml4IGZvcm0gKi9cclxuXHJcbiBmdW5jdGlvbiBmaXhGb3JtKCkge1xyXG4gICAgJChcIiNicmVha1RhZ1wiKS5jc3MoXCJkaXNwbGF5XCIsIFwiYmxvY2tcIik7XHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ2luRmFpbGVkXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxufVxyXG5cclxuXHJcbi8qIEV4dHJhIHN0dWZmICovXHJcblxyXG5cclxuZnVuY3Rpb24gZXh0cmFWYWxpZGF0aW9uKCkge1xyXG5cclxuICAgICQudmFsaWRhdG9yLmFkZE1ldGhvZCggXCJub3doaXRlc3BhY2VcIiwgZnVuY3Rpb24oIHZhbHVlLCBlbGVtZW50ICkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvbmFsKCBlbGVtZW50IClcclxuICAgICAgICAgfHwgL15cXFMrJC9pLnRlc3QoIHZhbHVlICk7XHJcbiAgICAgfSwgXCJObyB3aGl0ZSBzcGFjZSBwbGVhc2UuXCIpOyAgIFxyXG4gICAgIFxyXG4gICAgIFxyXG4gICAgICQudmFsaWRhdG9yLmFkZE1ldGhvZCgnc3Ryb25nVXNlcm5hbWUnLCBmdW5jdGlvbih2YWx1ZSwgZWxlbWVudCkge1xyXG4gICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25hbChlbGVtZW50KSBcclxuICAgICAgICAgICB8fCB2YWx1ZS5sZW5ndGggPj0gNlxyXG4gICAgICAgICAgICYmIC9bYS16XS9pLnRlc3QodmFsdWUpO1xyXG4gICAgICAgfSwgJ1VzZXJuYW1lIG11c3QgYmUgYXQgbGVhc3QgNiBjaGFyYWN0ZXJzIGxvbmcgYW5kIGNvbnRhaW4gYXQgbGVhc3Qgb25lIGxldHRlci4nKVxyXG4gICAgIFxyXG4gICAgIFxyXG4gICAgICQudmFsaWRhdG9yLmFkZE1ldGhvZCgnc3Ryb25nUGFzc3dvcmQnLCBmdW5jdGlvbih2YWx1ZSwgZWxlbWVudCkge1xyXG4gICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25hbChlbGVtZW50KSBcclxuICAgICAgICAgICB8fCB2YWx1ZS5sZW5ndGggPj0gOFxyXG4gICAgICAgICAgICYmIC9cXGQvLnRlc3QodmFsdWUpXHJcbiAgICAgICAgICAgJiYgL1thLXpdL2kudGVzdCh2YWx1ZSlcclxuICAgICAgICAgICAmJiAvWyQtLzotP3stfiFcIl5fYFxcW1xcXV0vLnRlc3QodmFsdWUpO1xyXG4gICAgICAgfSwgJ1Bhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgOCBjaGFyYWN0ZXJzIGxvbmcgYW5kIGNvbnRhaW4gYXQgbGVhc3Qgb25lIG51bWJlciwgb25lIGxldHRlciBhbmQgb25lIHN5bWJvbC4nKVxyXG4gICAgIFxyXG4gICAgIFxyXG4gICAgICQoXCIuc2lnbnVwLWZvcm1cIikudmFsaWRhdGUoe1xyXG4gICAgICAgICBydWxlczoge1xyXG4gICAgICAgICAgICAgc2lnbnVwVXNlcm5hbWU6IHtcclxuICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICBub3doaXRlc3BhY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgc3Ryb25nVXNlcm5hbWU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgbWF4bGVuZ3RoOiAyNFxyXG4gICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgIHNpZ251cEVtYWlsOiB7XHJcbiAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgZW1haWw6IHRydWVcclxuICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICBzaWdudXBQYXNzd29yZDoge1xyXG4gICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgIHN0cm9uZ1Bhc3N3b3JkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgIG5vd2hpdGVzcGFjZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICBtYXhsZW5ndGg6IDMyXHJcbiAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgY29uZmlybVBhc3N3b3JkOiB7XHJcbiAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgZXF1YWxUbzogXCIjcGFzc1wiLFxyXG4gICAgICAgICAgICAgICAgIG5vd2hpdGVzcGFjZTogdHJ1ZVxyXG4gICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgIG1lc3NhZ2VzOiB7XHJcbiAgICAgICAgICAgICAgICAgc2lnbnVwRW1haWw6IHtcclxuICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFwiUGxlYXNlIGVudGVyIGFuIGVtYWlsIGFkZHJlc3MuXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiBcIlBsZWFzZSBlbnRlciBhIHZhbGlkIGVtYWlsIGFkZHJlc3MuXCJcclxuICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICBcclxuICAgICBcclxuICAgICB9KTtcclxuXHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBleHRyYUNvbmZpcm1hdGlvbigpIHtcclxuXHJcbiAgICAkKFwiLnNpZ25pbi1mb3JtXCIpLnZhbGlkYXRlKHtcclxuICAgICAgICBydWxlczoge1xyXG4gICAgICAgICAgICBzaWduaW5FbWFpbDoge1xyXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBlbWFpbDogdHJ1ZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzaWduaW5QYXNzd29yZDoge1xyXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWVzc2FnZXM6IHtcclxuICAgICAgICAgICAgICAgIHNpZ25pbkVtYWlsOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFwiUGxlYXNlIGVudGVyIGFuIGVtYWlsIGFkZHJlc3MuXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IFwiUGxlYXNlIGVudGVyIGEgdmFsaWQgZW1haWwgYWRkcmVzcy5cIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICBcclxuICAgIH0pO1xyXG5cclxufSJdfQ==
