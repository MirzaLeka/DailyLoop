"use strict";function changeForm(e){var n=document.getElementById("form");0==e?(n.innerHTML='\n        \n        <form class="signup-form" onsubmit="register();return false">\n\n        <h2 class="formHeader">Sign Up</h2>\n\n        <input class="loginInput" name="signupUsername" type="text" placeholder="Username" autofocus/>\n    \n        <input class="loginInput" name="signupEmail" type="text" placeholder="Email"/>   \n    \n        <input class="loginInput" name="signupPassword" id="pass" type="password" placeholder="Password"/>\n\n        <input class="loginInput" name="confirmPassword" id="confirmPass" type="password" placeholder="Confirm Password"/>\n    <br>\n        <input class="btn btn-success formBtn" type="submit" id="confirmBtn" value="REGISTER"/>\n    \n        <p class="changeForm" onclick="changeForm(1)">Already a member?</p>\n\n    </form>\n        \n        ',extraValidation()):(n.innerHTML='\n\n        <form class="signin-form" onsubmit="login();return false">\n        \n        <h2 class="formHeader">Sign In</h2>\n    \n        <input class="loginInput" oninput="fixForm()" name="signinEmail" type="email" placeholder="Email" autofocus/>\n\n        <input class="loginInput" oninput="fixForm()" name="signinPassword" id="signinPass" type="password" placeholder="Password"/>\n            <label id="loginFailed">Incorrect username or password</label>\n    <br id="breakTag">\n        <input class="btn btn-primary formBtn" type="submit" id="loginBtn" value="CONTINUE"/>\n\n        <p class="changeForm" onclick="changeForm(0)">Not a member?</p>\n\n        </form>\n        \n        ',extraConfirmation())}function register(){extraValidation();var e=$("input[name='signupUsername']").val(),n=$("input[name='signupEmail']").val(),a=$("#pass").val(),s=$("#confirmPass").val();if(""!=e&&""!=n&&""!=a&&""!=s&&a==s){var i={username:e,email:n,password:a};$.ajax({type:"POST",url:"/users",contentType:"application/json",dataType:"json",data:JSON.stringify(i),success:function(e){window.location.href="/home"},error:function(e){e.responseJSON.errmsg.includes("username")?console.log("Username is already in use"):console.log("Email is already in use")}})}}function login(){extraConfirmation();var e=$("input[name='signinEmail']").val(),n=$("#signinPass").val();if(""!=e&&""!=n){var a={email:e,password:n};$.ajax({type:"POST",url:"/users/login",contentType:"application/json",dataType:"json",data:JSON.stringify(a),success:function(e){e&&(window.location.href="/home")},error:function(e){e&&(document.getElementById("loginFailed").style.display="block",$("#breakTag").css("display","none"))}})}}function fixForm(){$("#breakTag").css("display","block"),document.getElementById("loginFailed").style.display="none"}function extraValidation(){$.validator.addMethod("nowhitespace",function(e,n){return this.optional(n)||/^\S+$/i.test(e)},"No white space please."),$.validator.addMethod("strongUsername",function(e,n){return this.optional(n)||6<=e.length&&/[a-z]/i.test(e)},"Username must be at least 6 characters long and contain at least one letter."),$.validator.addMethod("strongPassword",function(e,n){return this.optional(n)||8<=e.length&&/\d/.test(e)&&/[a-z]/i.test(e)&&/[$-/:-?{-~!"^_`\[\]]/.test(e)},"Password must be at least 8 characters long and contain at least one number, one letter and one symbol."),$(".signup-form").validate({rules:{signupUsername:{required:!0,nowhitespace:!0,strongUsername:!0,maxlength:24},signupEmail:{required:!0,email:!0},signupPassword:{required:!0,strongPassword:!0,nowhitespace:!0,maxlength:32},confirmPassword:{required:!0,equalTo:"#pass",nowhitespace:!0},messages:{signupEmail:{required:"Please enter an email address.",email:"Please enter a valid email address."}}}})}function extraConfirmation(){$(".signin-form").validate({rules:{signinEmail:{required:!0,email:!0},signinPassword:{required:!0},messages:{signinEmail:{required:"Please enter an email address.",email:"Please enter a valid email address."}}}})}$(function(){$.validator.addMethod("nowhitespace",function(e,n){return this.optional(n)||/^\S+$/i.test(e)},"No white space please."),$.validator.addMethod("strongUsername",function(e,n){return this.optional(n)||6<=e.length&&/[a-z]/i.test(e)},"Username must be at least 6 characters long and contain at least one letter."),$.validator.addMethod("strongPassword",function(e,n){return this.optional(n)||8<=e.length&&/\d/.test(e)&&/[a-z]/i.test(e)&&/[$-/:-?{-~!"^_`\[\]]/.test(e)},"Password must be at least 8 characters long and contain at least one number, one letter and one symbol."),$(".signin-form").validate({rules:{signinEmail:{required:!0,email:!0},signinPassword:{required:!0,strongPassword:!0,nowhitespace:!0,maxlength:32},messages:{signinEmail:{required:"Please enter an email address.",email:"Please enter a valid email address."}}}}),$(".signup-form").validate({rules:{signupUsername:{required:!0,nowhitespace:!0,strongUsername:!0,maxlength:24},signupEmail:{required:!0,email:!0},signupPassword:{required:!0,strongPassword:!0,nowhitespace:!0,maxlength:32},confirmPassword:{required:!0,equalTo:"#pass",nowhitespace:!0},messages:{signupEmail:{required:"Please enter an email address.",email:"Please enter a valid email address."}}}})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2luLmpzIl0sIm5hbWVzIjpbImNoYW5nZUZvcm0iLCJudW0iLCJmb3JtIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsInZhbGlkYXRvciIsImV4dHJhQ29uZmlybWF0aW9uIiwicmVnaXN0ZXIiLCJleHRyYVZhbGlkYXRpb24iLCJkYXRhIiwiJCIsInZhbCIsImVtYWlsIiwicGFzc3dvcmQiLCJjb25maXJtIiwiYWpheCIsImRhdGFUeXBlIiwid2luZG93IiwidHlwZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdWNjZXNzIiwibG9jYXRpb24iLCJocmVmIiwiZXJyb3IiLCJlcnIiLCJyZXNwb25zZUpTT04iLCJlcnJtc2ciLCJpbmNsdWRlcyIsImNvbnNvbGUiLCJsb2ciLCJydWxlcyIsInJlcXVpcmVkIiwic3Ryb25nUGFzc3dvcmQiLCJub3doaXRlc3BhY2UiLCJtYXhsZW5ndGgiLCJjb250ZW50VHlwZSIsImNvbmZpcm1QYXNzd29yZCIsImVxdWFsVG8iLCJtZXNzYWdlcyIsInN0eWxlIiwiZGlzcGxheSIsImNzcyIsImFkZE1ldGhvZCIsInZhbHVlIiwiZWxlbWVudCIsInRoaXMiLCJvcHRpb25hbCIsInRlc3QiLCJsZW5ndGgiLCJ2YWxpZGF0ZSIsInNpZ251cFVzZXJuYW1lIiwic3Ryb25nVXNlcm5hbWUiLCJzaWdudXBFbWFpbCIsInNpZ251cFBhc3N3b3JkIiwic2lnbmluRW1haWwiLCJzaWduaW5QYXNzd29yZCIsInVzZXJuYW1lIiwiZXJyVHlwZSJdLCJtYXBwaW5ncyI6ImFBQ0EsU0FBU0EsV0FBV0MsR0FFaEIsSUFBSUMsRUFBT0MsU0FBU0MsZUFBZSxRQUV4QixHQUFQSCxHQUlBQyxFQUFLRyxVQUFMLCt4QkFpRU5DLG9CQWdCRkosRUFBQUcsVUFBQSwwckJBY2tCRSxxQkFnSGIsU0FBQUMsV0FFREMsa0JBRUEsSUFBSUMsRUFBT0MsRUFBQSxnQ0FBQUMsTUFDUEMsRUFBQUYsRUFBVUUsNkJBREhELE1BRVBF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LGlCQURTLFNBQUFZLEVBQUFDLEdBRVRqQyxPQUFBQSxLQUFBQSxTQUFPaUMsSUFUUixHQU9VRCxFQVBWSyxRQVdISyxTQUFBQSxLQUFBQSxJQUNJdEIsZ0ZBR0FHLEVBQUFBLFVBQUFBLFVBQUFBLGlCQUFXLFNBQUFTLEVBQUFDLEdBSkMsT0FBQUMsS0FYYkMsU0FBQUYsSUFpQkhSLEdBQUFBLEVBQUFBLFFBQ0lMLEtBQUFBLEtBQUFBLElBQ0FNLFNBQUFBLEtBQUFBLElBQ0FKLHVCQUFjYyxLQUFBSixJQUhELDJHQU1BbEMsRUFBQSxnQkFBQXdDLFNBQUEsQ0FEUG5CLE1BQUEsQ0F0QlB3QixZQUFBLENBdkJDdkIsVUFBVSxFQXNCdEJwQixPQUFBLEdBbkJRNEMsZUFBZ0IsQ0F5RGZqRCxVQUFXLEVBdkRSMEIsZ0JBQWdCLEVBeUR4QnpCLGNBQUFBLEVBdkRRMkIsVUFBVyxJQTBEZnZCLFNBQVUsQ0FDVkMsWUFBYSxDQUNiQyxTQUFZLGlDQXZESkYsTUFBTywyQ0FrRWZGLEVBQUEsZ0JBQUF3QyxTQUFhTyxDQUNiMUIsTUFBQSxDQUNBb0IsZUFBYXRDLENBSGpCbUIsVUFBQSxFQW5EUUUsY0FBYyxFQXlEZmtCLGdCQUFBLEVBQ0hsQyxVQURHLElBR0hrQixZQUFjLENBQ2RwQixVQUFVLEVBQ1ZQLE9BQVlXLEdBdERaa0MsZUFBZ0IsQ0F5RGhCckMsVUFBT0ssRUFSSlcsZ0JBQUEsRUE5Q0NDLGNBQWMsRUF5RGxCVixVQUFPLElBRUphLGdCQUFNcUIsQ0F2REwxQixVQUFVLEVBeURWTSxRQUFJb0IsUUFDQTdCLGNBQVFDLEdBRVJELFNBQUFBLENBQ0h3QixZQUFBLENBRUpyQixTQUFBLGlDQXJCTHBCLE1BQUEiLCJmaWxlIjoibG9naW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuZnVuY3Rpb24gY2hhbmdlRm9ybShudW0pIHtcclxuXHJcbiAgICBsZXQgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZm9ybVwiKTtcclxuXHJcbiAgICBpZiAobnVtID09IDApIHtcclxuICAgIFxyXG4gICAgICAgIC8qIFNpZ24gdXAgRm9ybSAqL1xyXG5cclxuICAgICAgICBmb3JtLmlubmVySFRNTCA9IGBcclxuICAgICAgICBcclxuICAgICAgICA8Zm9ybSBjbGFzcz1cInNpZ251cC1mb3JtXCIgb25zdWJtaXQ9XCJyZWdpc3RlcigpO3JldHVybiBmYWxzZVwiPlxyXG5cclxuICAgICAgICA8aDIgY2xhc3M9XCJmb3JtSGVhZGVyXCI+U2lnbiBVcDwvaDI+XHJcblxyXG4gICAgICAgIDxpbnB1dCBjbGFzcz1cImxvZ2luSW5wdXRcIiBuYW1lPVwic2lnbnVwVXNlcm5hbWVcIiB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiVXNlcm5hbWVcIiBhdXRvZm9jdXMvPlxyXG4gICAgXHJcbiAgICAgICAgPGlucHV0IGNsYXNzPVwibG9naW5JbnB1dFwiIG5hbWU9XCJzaWdudXBFbWFpbFwiIHR5cGU9XCJ0ZXh0XCIgcGxhY2Vob2xkZXI9XCJFbWFpbFwiLz4gICBcclxuICAgIFxyXG4gICAgICAgIDxpbnB1dCBjbGFzcz1cImxvZ2luSW5wdXRcIiBuYW1lPVwic2lnbnVwUGFzc3dvcmRcIiBpZD1cInBhc3NcIiB0eXBlPVwicGFzc3dvcmRcIiBwbGFjZWhvbGRlcj1cIlBhc3N3b3JkXCIvPlxyXG5cclxuICAgICAgICA8aW5wdXQgY2xhc3M9XCJsb2dpbklucHV0XCIgbmFtZT1cImNvbmZpcm1QYXNzd29yZFwiIGlkPVwiY29uZmlybVBhc3NcIiB0eXBlPVwicGFzc3dvcmRcIiBwbGFjZWhvbGRlcj1cIkNvbmZpcm0gUGFzc3dvcmRcIi8+XHJcbiAgICA8YnI+XHJcbiAgICAgICAgPGlucHV0IGNsYXNzPVwiYnRuIGJ0bi1zdWNjZXNzIGZvcm1CdG5cIiB0eXBlPVwic3VibWl0XCIgaWQ9XCJjb25maXJtQnRuXCIgdmFsdWU9XCJSRUdJU1RFUlwiLz5cclxuICAgIFxyXG4gICAgICAgIDxwIGNsYXNzPVwiY2hhbmdlRm9ybVwiIG9uY2xpY2s9XCJjaGFuZ2VGb3JtKDEpXCI+QWxyZWFkeSBhIG1lbWJlcj88L3A+XHJcblxyXG4gICAgPC9mb3JtPlxyXG4gICAgICAgIFxyXG4gICAgICAgIGA7XHJcblxyXG4gICAgICAgIGV4dHJhVmFsaWRhdGlvbigpO1xyXG5cclxuICAgICAgICAvLyBhY3Rpb249XCIvaG9tZVwiIG1ldGhvZD1cImdldFwiXHJcblxyXG4gICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgLyogU2lnbiBpbiBGb3JtICovXHJcblxyXG4gICAgICAgIGZvcm0uaW5uZXJIVE1MID0gYFxyXG5cclxuICAgICAgICA8Zm9ybSBjbGFzcz1cInNpZ25pbi1mb3JtXCIgb25zdWJtaXQ9XCJsb2dpbigpO3JldHVybiBmYWxzZVwiPlxyXG4gICAgICAgIFxyXG4gICAgICAgIDxoMiBjbGFzcz1cImZvcm1IZWFkZXJcIj5TaWduIEluPC9oMj5cclxuICAgIFxyXG4gICAgICAgIDxpbnB1dCBjbGFzcz1cImxvZ2luSW5wdXRcIiBvbmlucHV0PVwiZml4Rm9ybSgpXCIgbmFtZT1cInNpZ25pbkVtYWlsXCIgdHlwZT1cImVtYWlsXCIgcGxhY2Vob2xkZXI9XCJFbWFpbFwiIGF1dG9mb2N1cy8+XHJcblxyXG4gICAgICAgIDxpbnB1dCBjbGFzcz1cImxvZ2luSW5wdXRcIiBvbmlucHV0PVwiZml4Rm9ybSgpXCIgbmFtZT1cInNpZ25pblBhc3N3b3JkXCIgaWQ9XCJzaWduaW5QYXNzXCIgdHlwZT1cInBhc3N3b3JkXCIgcGxhY2Vob2xkZXI9XCJQYXNzd29yZFwiLz5cclxuICAgICAgICAgICAgPGxhYmVsIGlkPVwibG9naW5GYWlsZWRcIj5JbmNvcnJlY3QgdXNlcm5hbWUgb3IgcGFzc3dvcmQ8L2xhYmVsPlxyXG4gICAgPGJyIGlkPVwiYnJlYWtUYWdcIj5cclxuICAgICAgICA8aW5wdXQgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgZm9ybUJ0blwiIHR5cGU9XCJzdWJtaXRcIiBpZD1cImxvZ2luQnRuXCIgdmFsdWU9XCJDT05USU5VRVwiLz5cclxuXHJcbiAgICAgICAgPHAgY2xhc3M9XCJjaGFuZ2VGb3JtXCIgb25jbGljaz1cImNoYW5nZUZvcm0oMClcIj5Ob3QgYSBtZW1iZXI/PC9wPlxyXG5cclxuICAgICAgICA8L2Zvcm0+XHJcbiAgICAgICAgXHJcbiAgICAgICAgYDtcclxuXHJcbiAgICAgICAgZXh0cmFDb25maXJtYXRpb24oKTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxufVxyXG5cclxuXHJcbiQoZnVuY3Rpb24oKSB7XHJcblxyXG4kLnZhbGlkYXRvci5hZGRNZXRob2QoIFwibm93aGl0ZXNwYWNlXCIsIGZ1bmN0aW9uKCB2YWx1ZSwgZWxlbWVudCApIHtcclxuICAgcmV0dXJuIHRoaXMub3B0aW9uYWwoIGVsZW1lbnQgKVxyXG4gICAgfHwgL15cXFMrJC9pLnRlc3QoIHZhbHVlICk7XHJcbn0sIFwiTm8gd2hpdGUgc3BhY2UgcGxlYXNlLlwiKTsgICBcclxuXHJcblxyXG4kLnZhbGlkYXRvci5hZGRNZXRob2QoJ3N0cm9uZ1VzZXJuYW1lJywgZnVuY3Rpb24odmFsdWUsIGVsZW1lbnQpIHtcclxuICAgIHJldHVybiB0aGlzLm9wdGlvbmFsKGVsZW1lbnQpIFxyXG4gICAgICB8fCB2YWx1ZS5sZW5ndGggPj0gNlxyXG4gICAgICAmJiAvW2Etel0vaS50ZXN0KHZhbHVlKTtcclxuICB9LCAnVXNlcm5hbWUgbXVzdCBiZSBhdCBsZWFzdCA2IGNoYXJhY3RlcnMgbG9uZyBhbmQgY29udGFpbiBhdCBsZWFzdCBvbmUgbGV0dGVyLicpXHJcblxyXG5cclxuJC52YWxpZGF0b3IuYWRkTWV0aG9kKCdzdHJvbmdQYXNzd29yZCcsIGZ1bmN0aW9uKHZhbHVlLCBlbGVtZW50KSB7XHJcbiAgICByZXR1cm4gdGhpcy5vcHRpb25hbChlbGVtZW50KSBcclxuICAgICAgfHwgdmFsdWUubGVuZ3RoID49IDhcclxuICAgICAgJiYgL1xcZC8udGVzdCh2YWx1ZSlcclxuICAgICAgJiYgL1thLXpdL2kudGVzdCh2YWx1ZSlcclxuICAgICAgJiYgL1skLS86LT97LX4hXCJeX2BcXFtcXF1dLy50ZXN0KHZhbHVlKTtcclxuICB9LCAnUGFzc3dvcmQgbXVzdCBiZSBhdCBsZWFzdCA4IGNoYXJhY3RlcnMgbG9uZyBhbmQgY29udGFpbiBhdCBsZWFzdCBvbmUgbnVtYmVyLCBvbmUgbGV0dGVyIGFuZCBvbmUgc3ltYm9sLicpXHJcblxyXG5cclxuLyogU2lnbiBJbiBmb3JtIHZhbGlkYXRpb24gKi9cclxuXHJcbiQoXCIuc2lnbmluLWZvcm1cIikudmFsaWRhdGUoe1xyXG4gICAgcnVsZXM6IHtcclxuICAgICAgICBzaWduaW5FbWFpbDoge1xyXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZW1haWw6IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNpZ25pblBhc3N3b3JkOiB7XHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICBzdHJvbmdQYXNzd29yZDogdHJ1ZSxcclxuICAgICAgICAgICAgbm93aGl0ZXNwYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICBtYXhsZW5ndGg6IDMyXHJcbiAgICAgICAgfSxcclxuICAgICAgICBtZXNzYWdlczoge1xyXG4gICAgICAgICAgICBzaWduaW5FbWFpbDoge1xyXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFwiUGxlYXNlIGVudGVyIGFuIGVtYWlsIGFkZHJlc3MuXCIsXHJcbiAgICAgICAgICAgICAgICBlbWFpbDogXCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzLlwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxufSk7XHJcblxyXG4vKiBTaWduIFVwIGZvcm0gdmFsaWRhdGlvbiAqL1xyXG5cclxuJChcIi5zaWdudXAtZm9ybVwiKS52YWxpZGF0ZSh7XHJcbiAgICBydWxlczoge1xyXG4gICAgICAgIHNpZ251cFVzZXJuYW1lOiB7XHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICBub3doaXRlc3BhY2U6IHRydWUsXHJcbiAgICAgICAgICAgIHN0cm9uZ1VzZXJuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICBtYXhsZW5ndGg6IDI0XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzaWdudXBFbWFpbDoge1xyXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZW1haWw6IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNpZ251cFBhc3N3b3JkOiB7XHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICBzdHJvbmdQYXNzd29yZDogdHJ1ZSxcclxuICAgICAgICAgICAgbm93aGl0ZXNwYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICBtYXhsZW5ndGg6IDMyXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb25maXJtUGFzc3dvcmQ6IHtcclxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGVxdWFsVG86IFwiI3Bhc3NcIixcclxuICAgICAgICAgICAgbm93aGl0ZXNwYWNlOiB0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBtZXNzYWdlczoge1xyXG4gICAgICAgICAgICBzaWdudXBFbWFpbDoge1xyXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFwiUGxlYXNlIGVudGVyIGFuIGVtYWlsIGFkZHJlc3MuXCIsXHJcbiAgICAgICAgICAgICAgICBlbWFpbDogXCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzLlwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxufSk7XHJcblxyXG59KTtcclxuXHJcblxyXG5cclxuZnVuY3Rpb24gcmVnaXN0ZXIoKSB7XHJcblxyXG4gICAgZXh0cmFWYWxpZGF0aW9uKCk7XHJcblxyXG4gICAgbGV0IHVzZXJuYW1lID0gJChcImlucHV0W25hbWU9J3NpZ251cFVzZXJuYW1lJ11cIikudmFsKCk7XHJcbiAgICBsZXQgZW1haWwgPSAkKFwiaW5wdXRbbmFtZT0nc2lnbnVwRW1haWwnXVwiKS52YWwoKTtcclxuICAgIGxldCBwYXNzd29yZCA9ICQoXCIjcGFzc1wiKS52YWwoKTtcclxuICAgIGxldCBjb25maXJtID0gJChcIiNjb25maXJtUGFzc1wiKS52YWwoKTtcclxuXHJcbiAgICBpZiAodXNlcm5hbWUgPT0gXCJcIiB8fCBlbWFpbCA9PSBcIlwiIHx8IHBhc3N3b3JkID09IFwiXCIgfHwgY29uZmlybSA9PSBcIlwiKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChwYXNzd29yZCAhPSBjb25maXJtKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBkYXRhID0ge1xyXG4gICAgICAgIFwidXNlcm5hbWVcIiA6IHVzZXJuYW1lLFxyXG4gICAgICAgIFwiZW1haWxcIiA6IGVtYWlsLFxyXG4gICAgICAgIFwicGFzc3dvcmRcIiA6IHBhc3N3b3JkXHJcbiAgICB9O1xyXG5cclxuICAgICQuYWpheCh7XHJcbiAgICAgICAgdHlwZTogXCJQT1NUXCIsXHJcbiAgICAgICAgdXJsOiBcIi91c2Vyc1wiLFxyXG4gICAgICAgIGNvbnRlbnRUeXBlIDogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICBkYXRhIDogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cclxuICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL2hvbWVcIjtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7XHJcblxyXG4gICAgICAgICAgIGNvbnN0IGVyclR5cGUgPSAgZXJyLnJlc3BvbnNlSlNPTi5lcnJtc2c7XHJcblxyXG4gICAgICAgICAgICBpZiAoZXJyVHlwZS5pbmNsdWRlcyhcInVzZXJuYW1lXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVzZXJuYW1lIGlzIGFscmVhZHkgaW4gdXNlXCIpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFbWFpbCBpcyBhbHJlYWR5IGluIHVzZVwiKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcblxyXG59XHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIGxvZ2luKCkge1xyXG5cclxuICAgIGV4dHJhQ29uZmlybWF0aW9uKCk7XHJcblxyXG4gICAgbGV0IGVtYWlsID0gJChcImlucHV0W25hbWU9J3NpZ25pbkVtYWlsJ11cIikudmFsKCk7XHJcbiAgICBsZXQgcGFzc3dvcmQgPSAkKFwiI3NpZ25pblBhc3NcIikudmFsKCk7XHJcblxyXG4gICAgaWYgKGVtYWlsID09IFwiXCIgfHwgcGFzc3dvcmQgPT0gXCJcIikge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyB1cmw6IFwiL3VzZXJzL1wiICsgZW1haWwsXHJcblxyXG4gICAgbGV0IGRhdGEgPSB7XHJcbiAgICAgICAgXCJlbWFpbFwiIDogZW1haWwsXHJcbiAgICAgICAgXCJwYXNzd29yZFwiIDogcGFzc3dvcmRcclxuICAgIH1cclxuXHJcbiAgICAkLmFqYXgoe1xyXG4gICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgIHVybDogXCIvdXNlcnMvbG9naW5cIixcclxuICAgICAgICBjb250ZW50VHlwZSA6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICBkYXRhVHlwZSA6ICdqc29uJyxcclxuICAgICAgICBkYXRhIDogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvaG9tZVwiO1xyXG4gICAgICAgICAgICB9IFxyXG5cclxuICAgICAgICB9LFxyXG5cclxuICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyKSB7XHJcblxyXG4gICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2dpbkZhaWxlZFwiKS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgICAgICAkKFwiI2JyZWFrVGFnXCIpLmNzcyhcImRpc3BsYXlcIiwgXCJub25lXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG59XHJcblxyXG4gICAgLyogUmVtb3ZlIGxhYmVsIGFuZCBmaXggZm9ybSAqL1xyXG5cclxuIGZ1bmN0aW9uIGZpeEZvcm0oKSB7XHJcbiAgICAkKFwiI2JyZWFrVGFnXCIpLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKTtcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9naW5GYWlsZWRcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG59XHJcblxyXG5cclxuLyogRXh0cmEgc3R1ZmYgKi9cclxuXHJcblxyXG5mdW5jdGlvbiBleHRyYVZhbGlkYXRpb24oKSB7XHJcblxyXG4gICAgJC52YWxpZGF0b3IuYWRkTWV0aG9kKCBcIm5vd2hpdGVzcGFjZVwiLCBmdW5jdGlvbiggdmFsdWUsIGVsZW1lbnQgKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9uYWwoIGVsZW1lbnQgKVxyXG4gICAgICAgICB8fCAvXlxcUyskL2kudGVzdCggdmFsdWUgKTtcclxuICAgICB9LCBcIk5vIHdoaXRlIHNwYWNlIHBsZWFzZS5cIik7ICAgXHJcbiAgICAgXHJcbiAgICAgXHJcbiAgICAgJC52YWxpZGF0b3IuYWRkTWV0aG9kKCdzdHJvbmdVc2VybmFtZScsIGZ1bmN0aW9uKHZhbHVlLCBlbGVtZW50KSB7XHJcbiAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbmFsKGVsZW1lbnQpIFxyXG4gICAgICAgICAgIHx8IHZhbHVlLmxlbmd0aCA+PSA2XHJcbiAgICAgICAgICAgJiYgL1thLXpdL2kudGVzdCh2YWx1ZSk7XHJcbiAgICAgICB9LCAnVXNlcm5hbWUgbXVzdCBiZSBhdCBsZWFzdCA2IGNoYXJhY3RlcnMgbG9uZyBhbmQgY29udGFpbiBhdCBsZWFzdCBvbmUgbGV0dGVyLicpXHJcbiAgICAgXHJcbiAgICAgXHJcbiAgICAgJC52YWxpZGF0b3IuYWRkTWV0aG9kKCdzdHJvbmdQYXNzd29yZCcsIGZ1bmN0aW9uKHZhbHVlLCBlbGVtZW50KSB7XHJcbiAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbmFsKGVsZW1lbnQpIFxyXG4gICAgICAgICAgIHx8IHZhbHVlLmxlbmd0aCA+PSA4XHJcbiAgICAgICAgICAgJiYgL1xcZC8udGVzdCh2YWx1ZSlcclxuICAgICAgICAgICAmJiAvW2Etel0vaS50ZXN0KHZhbHVlKVxyXG4gICAgICAgICAgICYmIC9bJC0vOi0/ey1+IVwiXl9gXFxbXFxdXS8udGVzdCh2YWx1ZSk7XHJcbiAgICAgICB9LCAnUGFzc3dvcmQgbXVzdCBiZSBhdCBsZWFzdCA4IGNoYXJhY3RlcnMgbG9uZyBhbmQgY29udGFpbiBhdCBsZWFzdCBvbmUgbnVtYmVyLCBvbmUgbGV0dGVyIGFuZCBvbmUgc3ltYm9sLicpXHJcbiAgICAgXHJcbiAgICAgXHJcbiAgICAgJChcIi5zaWdudXAtZm9ybVwiKS52YWxpZGF0ZSh7XHJcbiAgICAgICAgIHJ1bGVzOiB7XHJcbiAgICAgICAgICAgICBzaWdudXBVc2VybmFtZToge1xyXG4gICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgIG5vd2hpdGVzcGFjZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICBzdHJvbmdVc2VybmFtZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICBtYXhsZW5ndGg6IDI0XHJcbiAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgc2lnbnVwRW1haWw6IHtcclxuICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICBlbWFpbDogdHJ1ZVxyXG4gICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgIHNpZ251cFBhc3N3b3JkOiB7XHJcbiAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgc3Ryb25nUGFzc3dvcmQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgbm93aGl0ZXNwYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgIG1heGxlbmd0aDogMzJcclxuICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICBjb25maXJtUGFzc3dvcmQ6IHtcclxuICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICBlcXVhbFRvOiBcIiNwYXNzXCIsXHJcbiAgICAgICAgICAgICAgICAgbm93aGl0ZXNwYWNlOiB0cnVlXHJcbiAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgbWVzc2FnZXM6IHtcclxuICAgICAgICAgICAgICAgICBzaWdudXBFbWFpbDoge1xyXG4gICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogXCJQbGVhc2UgZW50ZXIgYW4gZW1haWwgYWRkcmVzcy5cIixcclxuICAgICAgICAgICAgICAgICAgICAgZW1haWw6IFwiUGxlYXNlIGVudGVyIGEgdmFsaWQgZW1haWwgYWRkcmVzcy5cIlxyXG4gICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgIFxyXG4gICAgIFxyXG4gICAgIH0pO1xyXG5cclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGV4dHJhQ29uZmlybWF0aW9uKCkge1xyXG5cclxuICAgICQoXCIuc2lnbmluLWZvcm1cIikudmFsaWRhdGUoe1xyXG4gICAgICAgIHJ1bGVzOiB7XHJcbiAgICAgICAgICAgIHNpZ25pbkVtYWlsOiB7XHJcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGVtYWlsOiB0cnVlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNpZ25pblBhc3N3b3JkOiB7XHJcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtZXNzYWdlczoge1xyXG4gICAgICAgICAgICAgICAgc2lnbmluRW1haWw6IHtcclxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogXCJQbGVhc2UgZW50ZXIgYW4gZW1haWwgYWRkcmVzcy5cIixcclxuICAgICAgICAgICAgICAgICAgICBlbWFpbDogXCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzLlwiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgfSk7XHJcblxyXG59Il19
