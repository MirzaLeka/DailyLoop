<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
     <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <!-- jQuery library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>    
</head>
<body>

    Insert Text
    <input type="text" id="text"/> <br>
    Did you complete it
    <input type="text" id="completed"/> <br>
    When
    <input type="number" id="completedAt"/> <br>
    <br>  <br>
    <button class="btn btn-success" onclick="submit()">Submit Todo</button>
    
    <h2>Todos:</h2> 
    <br>

    <div id="main"></div>

    <!-- <br>
    <br>
    Find Todo 
    <input type="text" id="search" placeholder="Type id"/>
    <button class="btn btn-primary" onclick="search()">Search</button>

    <div id="todo"></div> -->

</body>
<style>

body{
    margin: 40px;
}

</style>


<script>

$(document).ready(() => {

$.ajax({
    type: "GET",
    url: "/todos",
    success: function(data) {

console.log(data);  

var list = '';

for (var i = 0; i < data.todos.length; i++) {
list += "<li>" + data.todos[i].text + "</li>";
}

document.getElementById("main").innerHTML = list;

    }

});

});

    var complete = false;

function submit() {

    var text = $("#text").val();
    var completed = $("#completed").val();

console.log("Completed value is " + completed);

    var completedAt = $("#completedAt").val();

    if (completed == ' ') {
        complete = true;
    }  else {
        complete == true;
    }

    console.log("Complete is " + complete + ", completedAt is" + completedAt);

var data = {
    "text": text,
    "completed": true,
    "completedAt" : completedAt
}

console.log("DAta is " + JSON.stringify(data));

$.ajax({
    type: "POST",
    url: "/todos",
    contentType : 'application/json',
    dataType : 'json',
    data : JSON.stringify(data),
    success: function(data) {
    
      location.reload(); // reloads page
    }

});


}

function search() {

    console.log("I'm inside");

var search = $("#search").val();

console.log("Value of search is " + search);

$.ajax({
    type: "GET",
    url: "/todos/" + search,
    sucess: function(data) {
        console.log(data);
    }
});

}


</script>

</html>