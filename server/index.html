<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
     <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <!-- jQuery library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>    
</head>
<body>

        <!-- <form action="/todos" method="POST" class"form-group">
          <label>Insert Todo</label><br>
          <input type="text" placeholder="e.g. Go to bed" class="form-control"/> <br>
          <input type="submit" class="btn btn-success" value="Submit"/> 
        </form> -->

    <!-- Did you complete it
    <input class="form-control" type="text" id="completed"/> <br>
    When
    <input type="number" id="completedAt"/> <br>
    <br>  <br> -->
    Insert Todo
    <input class="form-control" style="width: 250px" type="text" id="text"/> <br>
    <button class="btn btn-success" onclick="submit()">Submit Todo</button>
    
    <h2>Todos:</h2> 
    <br>

    <div id="main"></div>

    <br>
    <br>
    Delete Todo
    <input class="form-control" style="width: 250px" type="text" id="deleteText"/> <br>
    <button class="btn btn-danger" onclick="deleteTodo()">DELETE</button>

    <br> <br>
    <!-- Find Todo 
    <input type="text" id="search" placeholder="Type id"/>
    <button class="btn btn-primary" onclick="search()">Search</button>

    <div id="todo"></div> -->

</body>
<style>

body{
    margin: 40px;
}

</style>


<script>

$(document).ready(() => {

$.ajax({
    type: "GET",
    url: "/todos",
    success: function(data) {

console.log(data);  

var list = '';

for (var i = 0; i < data.todos.length; i++) {
list += "<li>" + data.todos[i].text + "</li>";
}

document.getElementById("main").innerHTML = list;

    }

});

});

    var complete = false;

function submit() {

    var text = $("#text").val();
    var completed = $("#completed").val();

console.log("Completed value is " + completed);

    var completedAt = $("#completedAt").val();

    if (completed == ' ') {
        complete = true;
    }  else {
        complete == true;
    }

    console.log("Complete is " + complete + ", completedAt is" + completedAt);

var data = {
    "text": text,
    "completed": true,
    "completedAt" : completedAt
}

console.log("DAta is " + JSON.stringify(data));

$.ajax({
    type: "POST",
    url: "/todos",
    contentType : 'application/json',
    dataType : 'json',
    data : JSON.stringify(data),
    success: function(data) {
    
      location.reload(); // reloads page
    }

});


}

function search() {

    console.log("I'm inside");

var search = $("#search").val();

console.log("Value of search is " + search);

$.ajax({
    type: "GET",
    url: "/todos/5b609055aedeae23fcfa9ddd/",
    contentType : 'application/json',
    dataType : 'json',
    sucess: function(data) {
       var myData = JSON.parse(data.responseText);
       
        console.log("succeeded");
        console.log(myData);
    }
});

}


function deleteTodo() {

    var deleteText = $("#deleteText").val();

    $.ajax({
    url: '/todos/' + deleteText,
    type: 'DELETE',
    success: function(result) {
        console.log("Deleted: \n" + result);
        location.reload();
    }
});
}


</script>

</html>